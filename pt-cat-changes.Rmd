---
title: "Changes to categorical data summaries"
output: 
  pdf_document: 
    extra_dependencies: 
      threeparttable:
      booktabs:
      mathdesign: utopia
      array:
    number_sections: true
    toc: true 
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = '.')
library(pmtables)
library(tidyverse)
```

\clearpage

# pt_cat_wide

## with by and panel

- the N column is new

```{r, results = "asis"}
pt_cat_wide(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf),
  by = vars(Study = STUDYf),
  panel =  c(`Formulation: ` = "FORMf")
) %>% as_stable() %>% pt_wrap(stdout())
```

\clearpage

## with panel

- the N column is new

- I don't like the way this looks; would prefer using `by` here; but I think 
this output is what you would expect given the data and option

```{r, results = "asis"}
pt_cat_wide(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf),
  panel = c(`Formulation: ` = "FORMf"), 
  all_name = "All formulations"
) %>% as_stable() %>% pt_wrap(stdout())
```


\clearpage

## with by

- the N column is new

```{r, results = "asis"}
pt_cat_wide(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf),
  by =  c(Formulation = "FORMf")
) %>% as_stable() %>% pt_wrap(stdout())
```


\clearpage

## ungrouped

- the N column is new

```{r, results = 'asis'}
pt_cat_wide(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf)
) %>% as_stable() %>% pt_wrap(stdout())
```

## Drop the N

```{r, results = 'asis'}
out <- pt_cat_wide(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf), 
  drop = "N"
) 
```

```{r, results = "asis"}
out %>% as_stable() %>% pt_wrap(stdout())
```


\clearpage

# pt_cont_long

We now add a summary row to the bottom of the table.

## With spanning data item (formulation)


```{r, results = "asis"}
pt_cat_long(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf, `Child-Pugh` = CPf),
  span = vars(Study = STUDYf)
) %>% as_stable() %>% pt_wrap(stdout())
```

\clearpage

```{r, results = "asis"}
pt_cat_long(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf, `Child-Pugh` = CPf),
  span = vars(Formulation = FORMf),
  all_name_span = "All ... Formulations", 
  summarize = "both"
) %>% as_stable() %>% pt_wrap(stdout())
```


\clearpage

```{r, results = "asis"}
pt_cat_long(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf, `Child-Pugh` = CPf),
  span = vars(Study = STUDYf),
  summarize = "none"
) %>% as_stable() %>% pt_wrap(stdout())
```


\clearpage

## Without spanning data item

```{r, results = "asis"}
mini <-  noteconf(type  = "minipage", width = 0.3)
pt_cat_long(
  pmt_first,
  cols = vars(Sex = SEXf, `Renal function` = RFf, `Child-Pugh` = CPf)
) %>% as_stable(note_config = mini) %>% pt_wrap(stdout())

```

